# get all system dependencies

- name: System block
  tags: [system]
  block:

    - name: Download additional files
      ansible.builtin.get_url:
        url: "{{ item.url }}"
        dest: "{{ item.dest }}"
        mode: "0644"
      loop: "{{download_extras}}"

    - name: Install system dependencies from registries
      ansible.builtin.package:
        name: "{{ item }}"
        state: present
      loop: "{{ apt_developer }}"
      when: not item.startswith('/')

    - name: Install local system dependencies
      ansible.builtin.package:
        deb: "{{ item }}"
        state: present
      loop: "{{ apt_developer }}"
      when: item.startswith('/')

    - name: Register system dependencies for the runtime stage
      ansible.builtin.lineinfile:
        path: "{{configure_folder}}/runtime_debs"
        regexp: "^{{ item }}$"
        line: "{{ item }}"
        create: true
      loop: "{{ apt_runtime }}"
